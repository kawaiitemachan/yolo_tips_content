# YOLOv11n-seg セグメンテーショントレーニングプロジェクト

このプロジェクトは、カスタムデータセットを使用してYOLOv11nセグメンテーションモデルをトレーニングするための環境です。

## プロジェクト構成
- `dataset/` - トレーニングデータとdata.yaml設定ファイルを含むディレクトリ
- `config.yaml` - トレーニングパラメータの設定ファイル
- `train_yolov11n_seg.bat` - ワンクリックでセグメンテーションモデルのトレーニングを開始するためのWindowsバッチファイル
- `setup_environment.bat` - Python環境をセットアップするためのスクリプト
- `detect_mosaic.bat` - トレーニング済みモデルでセグメンテーションを実行し、検出された対象にモザイクをかけるスクリプト
- `detect.py` - セグメンテーションとモザイク処理のPythonスクリプト

## 使用方法

### 初回セットアップ
1. Windowsマシンに Python がインストールされていることを確認してください
2. `setup_environment.bat` をダブルクリックして、仮想環境を作成し必要なパッケージをインストールします

### トレーニング
1. `train_yolov11n_seg.bat` をダブルクリックしてセグメンテーションモデルのトレーニングプロセスを開始します
2. スクリプトは以下の処理を行います:
   - 仮想環境を有効化
   - `config.yaml` が存在する場合はそれを使用し、存在しない場合はデフォルトパラメータを使用
   - データセットを使用してトレーニングを開始

### モザイク処理による推論
1. トレーニングが完了したら、`detect_mosaic.bat` をダブルクリックします
2. プロンプトに従って以下の情報を入力します:
   - 処理したい画像のフォルダパス
   - モザイクのピクセルサイズ（小さい値ほど粗いモザイク）
   - 検出信頼度閾値
3. 処理結果は `runs/segment/mosaic_results` ディレクトリに保存されます

## トレーニング結果
トレーニング結果は `runs/segment/yolov11n_seg_custom_model` ディレクトリに保存され、以下を含みます:
- ベストウェイト: `best.pt`
- 最終ウェイト: `last.pt`
- トレーニングメトリクスとグラフ
- 検証結果

## カスタマイズ
トレーニングパラメータをカスタマイズするには、`config.yaml` ファイルを編集します。

主要パラメータ:
- `model: yolo11n-seg.pt` - セグメンテーションベースモデル
- `epochs: 100` - トレーニングエポック数
- `imgsz: 640` - トレーニング画像サイズ
- `batch: 4` - バッチサイズ
- `workers: 4` - ワーカースレッド数
- `device: 0` - GPUデバイス（CPUのみを使用する場合は 'cpu'）
- `name: yolov11n_seg_custom_model` - 出力モデルの名前

このシステムは、`data.yaml` で定義されたクラス数やクラス名の変更に自動的に対応し、YOLOv11のデフォルトのオーグメンテーション設定を使用します。